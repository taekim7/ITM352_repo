<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src = "./products.js"></script>
</head>
<body>
    <script>
    let params = (new URL(document.location)).searchParams;
    let q = Number(params.get('quantity'));

    let brand = products[0]['brand'];
    let brand_price = products[0]['price'];

    
    //response.send(request.body); 
    //let q = Number(request.body['qty_textbox']);
    console.log("The input value is... " + q);
    //Increments the # of items sold for the first item in products
    //products[0].total_sold += q;

    let validationMessage = validateQuantity(q);

    if (validationMessage === "") {
        document.write(`<h2>Thank you for purchasing ${q} ${brand}. Your total is \$${q * brand_price}!</h2>`);
    } else {
        alert(validationMessage + '<br>' + `Error: ${q} is not a quantity. Hit the back button to fix.`);
        document.write(validationMessage + '<br>' + `Error: ${q} is not a quantity. Hit the back button to fix.`);
    }

    function validateQuantity (quantity) {
    if (isNaN(quantity)) {
    return "Not a number";
    }else if (quantity < 0 && !Number.isInteger(quantity)) {
    return "Negative Inventory and not an integer";
    }else if (quantity <0){
    return "Negative Inventory";
    }else if (!Number.isInteger(quantity)){
    return "not an integer";
    }else {
    return "";
    }
    }
    </script>
</body>
</html>